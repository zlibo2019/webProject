webpackJsonp([26],{"+Bly":function(t,e,a){"use strict";function n(t){a("r9gR")}Object.defineProperty(e,"__esModule",{value:!0});var o=a("bOdI"),r=a.n(o),i=a("bWJ8"),l=a("qqG0"),s={name:"HelloWorld",components:{Button:i.a,Toast:l.a},computed:{defaultErrImg:function(){return'this.src="'+this.$store.state.Common.defaultErrImg+'"'}},data:function(){var t;return t={daterange:[],onTime:1,mySearch:"",tableData1:[{userName:"王小二",userDepname:"初一年级",userNo:"20320230",userPhoto:"15349885350.118830e652g97.jpg",leaveTime:"2018-12-05 15:00",ltUser:"admin",family_name:"李大钊",relationshipData:"母子",tel:"18744551234",accountType:"主账号"},{userName:"王小二",userDepname:"初一年级",userNo:"20320230",userPhoto:"15349885350.118830e652g97.jpg",leaveTime:"2018-12-05 15:00",ltUser:"admin",family_name:"王晓晓",relationshipData:"父子",tel:"18744551234",accountType:"次账号"},{userName:"王大二",userDepname:"初一年级",userNo:"20320231",userPhoto:"15349885350.118830e652g97.jpg",leaveTime:"2018-12-05 15:00",ltUser:"admin",family_name:"王晓晓",relationshipData:"父子",tel:"18744551234",accountType:"次账号"},{userName:"王大二",userDepname:"初一年级",userNo:"20320231",userPhoto:"15349885350.118830e652g97.jpg",leaveTime:"2018-12-05 15:00",ltUser:"admin",family_name:"李大钊",relationshipData:"母子",tel:"18744551234",accountType:"主账号"},{userName:"王小三",userDepname:"初二年级",userNo:"20320220",userPhoto:"15349885350.118830e652g97.jpg",leaveTime:"2018-12-05 15:00",ltUser:"admin",family_name:"王晓晓",relationshipData:"父子",tel:"18744551234",accountType:"次账号"}]},r()(t,"tableData1",[]),r()(t,"tableData2",[r()({className:null,dicFmtMap:{userDutycn:"教师"},userDep:100118,userDepname:"sll办公室",userDuty:"2",userName:"教师119",userNo:"119",userPhoto:"",userTel:"17766655553",ltDate:"离职时间",ltUser:"操作人"},"userPhoto","15349885350.118830e652g97.jpg")]),r()(t,"tableData2",[]),r()(t,"showIndex",!1),r()(t,"allNum",0),r()(t,"currentPage",1),r()(t,"tableLoading1",!1),r()(t,"tableLoading2",!1),r()(t,"pageItem",20),r()(t,"isToast",!1),r()(t,"toast",""),r()(t,"transferState",!1),r()(t,"treeData",[{id:10003,pid:10001,lable:"班级",lv:2,group:102,isLeaf:0,children:[{id:10009,pid:10003,lable:"高中部",lv:3,group:103,isLeaf:0,children:[{id:10013,pid:10009,lable:"高三",lv:4,group:104,isLeaf:1,children:[]},{id:10011,pid:10009,lable:"高一",lv:4,group:104,isLeaf:0,children:[{id:10014,pid:10011,lable:"一班",lv:5,group:105,isLeaf:1,children:[]},{id:100017,pid:10011,lable:"二班",lv:5,group:105,isLeaf:1,children:[]}]},{id:10012,pid:10009,lable:"高二",lv:4,group:104,isLeaf:1,children:[]}]},{id:10010,pid:10003,lable:"初中部",lv:3,group:103,isLeaf:1,children:[]}]}]),r()(t,"defaultProps",{children:"children",label:"lable"}),r()(t,"depExpandedKeys",[]),r()(t,"depStr",""),r()(t,"quitPersons",[{name:"学生"},{name:"教师"}]),r()(t,"onPerson",0),r()(t,"spanArr",[]),t},methods:{search:function(){0==this.onPerson?this.getTableData1():1==this.onPerson&&this.getTableData2()},exportExcel:function(){$("#exportForm").submit()},depChangeClick:function(){var t=this;this.transferState=!this.transferState,this.depExpandedKeys=[],this.classExpandedKeys=[],this.treeData.length>0&&this.treeData.forEach(function(e){t.depExpandedKeys.push(e.id)})},selectDeparment:function(t){101!=t.group?this.depStr=t.lable:this.$message({showClose:!0,message:"请选择部门",type:"warning",duration:this.msgDuration}),this.transferState=!1},clickPersonTag:function(t){this.onPerson=t,this.currentPage=1,0==t?this.getTableData1():1==t&&this.getTableData2()},selectToday:function(t){this.onTime=1,this.daterange=[],0==this.onPerson?this.getTableData1():1==this.onPerson&&this.getTableData2()},changeDateRange:function(t){this.onTime="",0==this.onPerson?this.getTableData1():1==this.onPerson&&this.getTableData2()},getTableData1:function(){var t=this,e=void 0;if(1==this.onTime){var a=(new Date).getFullYear(),n=(new Date).getMonth()+1;n=n<10?"0"+n:n;var o=(new Date).getDate();o=o<10?"0"+o:o;var r=(new Date).getHours();r=r<10?"0"+r:r;var i=(new Date).getMinutes();i=i<10?"0"+i:i;var l=(new Date).getSeconds();l=l<10?"0"+l:l;e=[a+"-"+n+"-"+o+" 00:00:00",a+"-"+n+"-"+o+" 23:59:59"]}else e=this.daterange;var s={count:!0,page_index:this.currentPage,page_size:this.pageItem,search:{beginDate:e[0],endDate:e[1],schoolId:localStorage.getItem("schoolId"),userState:2,userNameLike:this.mySearch}};this.tableLoading1=!0,this.$api.DataCount.getStudentRecord(s).then(function(e){if(t.tableLoading1=!1,600==e.data.code||0==e.data.code){null!=e.data.data?t.allNum=e.data.data.total_record:t.allNum=0,t.tableData1=e.data.data.records,t.getSpanArr(t.tableData1);for(var a=0,n=0;n<t.tableData1.length;n++)0===n?a=1:t.tableData1[n].userNo!=t.tableData1[n-1].userNo&&(a+=1),t.$set(t.tableData1[n],"indexID",(t.currentPage-1)*t.pageItem+1*a)}else t.isToast=!0,t.toast=e.data.msg}).catch(function(e){t.tableLoading1=!1})},getTableData2:function(){var t=this,e=void 0;if(1==this.onTime){var a=(new Date).getFullYear(),n=(new Date).getMonth()+1;n=n<10?"0"+n:n;var o=(new Date).getDate();o=o<10?"0"+o:o;var r=(new Date).getHours();r=r<10?"0"+r:r;var i=(new Date).getMinutes();i=i<10?"0"+i:i;var l=(new Date).getSeconds();l=l<10?"0"+l:l;e=[a+"-"+n+"-"+o+" 00:00:00",a+"-"+n+"-"+o+" 23:59:59"]}else e=this.daterange;var s={count:!0,page_index:this.currentPage,page_size:this.pageItem,search:{beginDate:e[0],endDate:e[1],schoolId:localStorage.getItem("schoolId"),userState:2,userNameLike:this.mySearch}};this.tableLoading2=!0,this.$api.DataCount.getTeacherRecord(s).then(function(e){t.tableLoading2=!1,600==e.data.code||0==e.data.code?(null!=e.data.data?t.allNum=e.data.data.total_record:t.allNum=0,t.tableData2=e.data.data.records,$.each(t.tableData2,function(e,a){t.$set(t.tableData2[e],"indexID",(t.currentPage-1)*t.pageItem+e+1)})):(t.allNum=0,t.isToast=!0,t.toast=e.data.msg)}).catch(function(e){t.tableLoading2=!1})},objectSpanMethod:function(t){var e=(t.row,t.column,t.rowIndex);if(t.columnIndex<=6){var a=this.spanArr[e];return{rowspan:a,colspan:a>0?1:0}}},getSpanArr:function(t){this.spanArr=[];for(var e=0;e<t.length;e++)0==e?(this.spanArr.push(1),this.pos=0):t[e].userSerial==t[e-1].userSerial?(this.spanArr[this.pos]+=1,this.spanArr.push(0)):(this.spanArr.push(1),this.pos=e)},initLayout:function(){setTimeout(function(){var t=$(".index > .m-cen").height(),e=$(".turn-top").height(),a=$(".operate-box").height(),n=$(".pagination-box").height(),o=t-e-a-n-15;$(".table-box").height(o),$(".table-box1").height(o),$(".table-box2").height(o)},15)},handleSelectionChange:function(t){this.multipleSelection=t},toggleSelection:function(t){this.$refs.multipleTable.toggleRowSelection(t)},handleSizeChange:function(t){this.pageItem=t,this.currentPage=1,this.changePage(this.pageItem,this.currentPage)},handleCurrentChange:function(t){this.currentPage=t,0==this.onPerson?this.getTableData1():1==this.onPerson&&this.getTableData2()},hideToast:function(){this.isToast=!1}},mounted:function(){var t=this;document.body.onclick=function(e){0==$(e.target).closest(".deparment").length&&(t.transferState=!1)},this.initLayout(),this.getTableData1()}},c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"quit-record"},[a("div",{staticClass:"turn-top"},[a("div",{staticClass:"turn-box"},[a("span",[t._v("离校/离职人员：")]),t._v(" "),t._l(t.quitPersons,function(e,n){return a("el-button",{key:n,class:{on:t.onPerson==n},attrs:{type:"text"},on:{click:function(e){return t.clickPersonTag(n)}}},[t._v(t._s(e.name))])})],2),t._v(" "),a("div",{staticClass:"turn-box"},[a("span",[t._v("时间范围：")]),t._v(" "),a("el-button",{class:{on:1==t.onTime},attrs:{type:"text"},on:{click:t.selectToday}},[t._v("今天")]),t._v(" "),a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"]},on:{change:t.changeDateRange},model:{value:t.daterange,callback:function(e){t.daterange=e},expression:"daterange"}})],1)]),t._v(" "),a("div",{staticClass:"turn-bottom"},[a("div",{staticClass:"operate-box"},[a("span",[t._v(t._s(t.allNum)+"位"+t._s(0==t.onPerson?"学生":"教师"))]),t._v(" "),a("iframe",{staticStyle:{display:"none"},attrs:{id:"id_iframe",name:"id_iframe"}}),t._v(" "),a("div",{staticClass:"search-box"},[a("el-input",{attrs:{size:"small",placeholder:"请输入姓名或者学/工号"},on:{change:t.search},model:{value:t.mySearch,callback:function(e){t.mySearch=e},expression:"mySearch"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"suffix"},on:{click:t.search},slot:"suffix"})])],1)]),t._v(" "),a("div",{staticClass:"table-box"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading1,expression:"tableLoading1"},{name:"show",rawName:"v-show",value:0==t.onPerson,expression:"onPerson == 0"}],ref:"studentTable",staticStyle:{width:"100%"},attrs:{"span-method":t.objectSpanMethod,border:"",data:t.tableData1,height:" 100%","tooltip-effect":"dark"}},[a("el-table-column",{attrs:{label:"学生档案"}},[a("el-table-column",{attrs:{prop:"indexID",label:"序号",width:"65"}}),t._v(" "),a("el-table-column",{attrs:{prop:"userName",label:"姓名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"userDepname",label:"班级","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"userNo",label:"学号","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"userPhoto",label:"档案照片"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.userPhoto?a("el-popover",{attrs:{trigger:"hover",placement:"bottom"}},[a("img",{staticStyle:{width:"auto"},attrs:{src:t.uploadPicUrl+e.row.userPhoto+"?imageView2/1/w/200/h/260",onerror:t.defaultErrImg}}),t._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{staticStyle:{background:"none",color:"#1cab7d",border:"none"},attrs:{size:"medium"}},[t._v("预览\n                                    ")])],1)]):a("span",[t._v("无")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"ltDate",label:"离校时间","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"ltUserId",label:"操作人","show-overflow-tooltip":""}})],1),t._v(" "),a("el-table-column",{attrs:{label:"家长信息"}},[a("el-table-column",{attrs:{prop:"family_name",label:"家长姓名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"relationshipData",label:"与学生关系","min-width":"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"tel",label:"联系电话","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"bandingOrder",label:"账号类型"}})],1)],1),t._v(" "),a("el-table",{directives:[{name:"show",rawName:"v-show",value:1==t.onPerson,expression:"onPerson == 1"},{name:"loading",rawName:"v-loading",value:t.tableLoading2,expression:"tableLoading2"}],ref:"teacherTable",staticStyle:{width:"100%"},attrs:{height:"100%",data:t.tableData2,border:"","highlight-current-row":""},on:{"row-click":t.toggleSelection,"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{prop:"indexID",label:"序号",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"userNo",label:"工号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"userName",label:"姓名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"userDepname",label:"部门"}}),t._v(" "),a("el-table-column",{attrs:{prop:"userTel",label:"联系电话"}}),t._v(" "),a("el-table-column",{attrs:{prop:"dicFmtMap",label:"职位",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.dicFmtMap?e.row.dicFmtMap.userDutycn:""))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"userPhoto",label:"档案照片"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.userPhoto?a("el-popover",{attrs:{trigger:"hover",placement:"bottom"}},[a("img",{staticStyle:{width:"auto"},attrs:{src:t.uploadPicUrl+e.row.userPhoto+"?imageView2/1/w/200/h/260",onerror:t.defaultErrImg}}),t._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{staticStyle:{background:"none",color:"#1cab7d",border:"none"},attrs:{size:"medium"}},[t._v("预览")])],1)]):a("span",[t._v("无")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"ltDate",label:"离职时间",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ltUserId",label:"操作人",align:"center"}})],1)],1),t._v(" "),a("div",{staticClass:"pagination-box"},[a("el-pagination",{attrs:{background:"",layout:" prev, pager, next",total:t.allNum,"page-size":t.pageItem,"current-page":t.currentPage},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"current-change":t.handleCurrentChange}})],1)]),t._v(" "),t.isToast?a("Toast",{attrs:{"modal-title":t.toast,duration:"1000"},on:{toastCancel:t.hideToast}}):t._e()],1)},u=[],d={render:c,staticRenderFns:u},p=d,h=a("VU/8"),g=n,b=h(s,p,!1,g,"data-v-c9a51662",null);e.default=b.exports},YKyE:function(t,e,a){e=t.exports=a("FZ+f")(!1),e.push([t.i,"\n.quit-record[data-v-c9a51662] {\n  width: 100%;\n  height: 100%;\n  margin: 0 auto;\n}\n.quit-record .turn-top[data-v-c9a51662] {\n    width: 100%;\n    height: auto;\n    background: #fff;\n    margin-bottom: 15px;\n    padding: 0 35px;\n}\n.quit-record .turn-top .turn-box[data-v-c9a51662] {\n      width: 100%;\n      height: 50px;\n      border-bottom: 1px solid #E1E1E1;\n      line-height: 50px;\n      font-size: 12px;\n      color: #333;\n}\n.quit-record .turn-top .turn-box span[data-v-c9a51662] {\n        margin: 0 20px;\n        margin-left: 0;\n}\n.quit-record .turn-top .turn-box[data-v-c9a51662] button {\n        color: #AAAAAA;\n        margin-left: 10px;\n}\n.quit-record .turn-top .turn-box[data-v-c9a51662] button span {\n          margin-right: 10px;\n}\n.quit-record .turn-top .turn-box button.on[data-v-c9a51662] {\n        color: #333;\n}\n.quit-record .turn-top .turn-box[data-v-c9a51662] .el-date-editor {\n        margin: 0 20px;\n}\n.quit-record .turn-top .turn-box[data-v-c9a51662] .el-date-editor span {\n          margin: 0;\n}\n.quit-record .turn-top .turn-box[data-v-c9a51662] .el-date-editor input:focus {\n          border: 0 !important;\n}\n.quit-record .turn-top .turn-box .el-select .el-input input[data-v-c9a51662] {\n        height: 40px !important;\n}\n.quit-record .turn-top .turn-box .el-select .el-input span[data-v-c9a51662] {\n        margin: 0;\n}\n.quit-record .turn-top .turn-box .transfer-content[data-v-c9a51662] {\n        height: auto !important;\n        min-height: 0 !important;\n        text-align: center;\n        display: inline-block !important;\n        position: relative;\n        margin-left: 20px;\n        vertical-align: middle;\n}\n.quit-record .turn-top .turn-box .transfer-content .transfer-top[data-v-c9a51662] {\n          width: 123px;\n          height: 40px;\n          line-height: 40px;\n          position: relative;\n          margin-bottom: 3px;\n          padding-left: 15px;\n          border-radius: 5px;\n          border: 1px solid #E5E5E5;\n          text-align: left;\n          cursor: pointer;\n          background: #fff;\n}\n.quit-record .turn-top .turn-box .transfer-content .transfer-top span[data-v-c9a51662] {\n            font-size: 12px;\n            display: inline-block;\n            width: 75px;\n            overflow: hidden;\n            white-space: nowrap;\n}\n.quit-record .turn-top .turn-box .transfer-content .transfer-top img[data-v-c9a51662] {\n            position: absolute;\n            top: 0;\n            bottom: 0;\n            right: 12px;\n            margin: auto;\n            -webkit-transition: 0.3s;\n            transition: 0.3s;\n            width: 12px;\n}\n.quit-record .turn-top .turn-box .transfer-content .transfer-top .arrow-up[data-v-c9a51662] {\n            -webkit-transform: rotate(-180deg);\n            transform: rotate(-180deg);\n}\n.quit-record .turn-top .turn-box .transfer-content .inner-tree[data-v-c9a51662] {\n          width: 150px;\n          width: auto;\n          min-width: 123px;\n          height: auto;\n          max-height: 250px;\n          overflow-y: auto;\n          padding: 15px 10px;\n          background: #fff;\n          position: absolute;\n          top: 50px;\n          left: 0px;\n          z-index: 20;\n          border: 1px solid #E1E1E1;\n          border-radius: 5px;\n          -webkit-box-sizing: content-box;\n          box-sizing: content-box;\n}\n.quit-record .turn-top .turn-box[data-v-c9a51662]:last-child {\n        border: 0;\n}\n.quit-record .turn-bottom[data-v-c9a51662] {\n    width: 100%;\n    height: auto;\n    background: #fff;\n}\n.quit-record .turn-bottom .operate-box[data-v-c9a51662] {\n      width: 100%;\n      height: 60px;\n      line-height: 60px;\n      -webkit-box-sizing: content-box;\n              box-sizing: content-box;\n      border-bottom: 1px solid #e1e1e1;\n}\n.quit-record .turn-bottom .operate-box span[data-v-c9a51662] {\n        font-size: 18px;\n        font-weight: bold;\n        color: #333;\n        margin-left: 35px;\n}\n.quit-record .turn-bottom .operate-box .exportBtn[data-v-c9a51662] {\n        width: 90px;\n        margin: 5px 20px;\n        background: #F5F6F5 !important;\n        border: 1px solid #E6E6E6 !important;\n        color: #333;\n}\n.quit-record .turn-bottom .operate-box .exportBtn[data-v-c9a51662]:hover {\n        background: #1cab7d !important;\n        color: #fff !important;\n}\n.quit-record .turn-bottom .operate-box .search-box[data-v-c9a51662] {\n        width: 200px;\n        height: 36px;\n        float: right;\n        margin: 0px 80px 0px 20px;\n        margin-right: 10px;\n        background: #fff;\n        position: relative;\n}\n.quit-record .turn-bottom .operate-box .search-box .el-input i[data-v-c9a51662] {\n          cursor: pointer;\n}\n.quit-record .turn-bottom .operate-box #exportForm[data-v-c9a51662] {\n        display: none;\n}\n.quit-record .turn-bottom .table-box[data-v-c9a51662] .el-table {\n      border-left: 0;\n      border-right: 0;\n}\n.quit-record .turn-bottom .table-box[data-v-c9a51662] .el-table .el-table__header thead tr {\n        cursor: default;\n}\n.quit-record .turn-bottom .table-box[data-v-c9a51662] .el-table .el-table__header thead tr:nth-of-type(2) th {\n          background-color: #fff;\n}\n.quit-record .turn-bottom .pagination-box[data-v-c9a51662] {\n      width: 100%;\n      height: 60px;\n      background: #fff;\n      -webkit-box-sizing: content-box;\n              box-sizing: content-box;\n}\n.quit-record .turn-bottom .pagination-box .el-pagination[data-v-c9a51662] {\n        padding-top: 15px;\n}\n.el-popover[data-v-c9a51662] {\n  padding: 36px 50px 16px;\n}\n",""])},r9gR:function(t,e,a){var n=a("YKyE");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a("rjj0")("555dcba5",n,!0,{})}});