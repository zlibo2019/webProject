webpackJsonp([53],{"Fy/p":function(t,e,n){"use strict";function i(t){n("jvYm")}Object.defineProperty(e,"__esModule",{value:!0});var a=n("bOdI"),o=n.n(a),r=n("bWJ8"),s=n("qqG0"),d={name:"CardMonitor",components:{Button:r.a,Toast:s.a},data:function(){var t;return t={isToast:!1,toast:"",btn2Data:{iconL:n("KcoX"),iconLAct:n("0Qjn")},treeData:[{id:1e3,pid:101,label:"烟台一中",group:102,isLeaf:0,children:[{id:1e4,pid:1e3,label:"初一一班教室",group:103,isLeaf:1,children:[]},{id:10001,pid:1e3,label:"初一二班教室",group:103,isLeaf:1,children:[]},{id:10002,pid:1e3,label:"初一三班教室",group:103,isLeaf:1,children:[]},{id:10003,pid:1e3,label:"初一四班教室",group:103,isLeaf:1,children:[]},{id:10004,pid:1e3,label:"初一五班教室",group:103,isLeaf:1,children:[]},{id:10005,pid:1e3,label:"初一五班教室",group:103,isLeaf:1,children:[]}]}]},o()(t,"treeData",[]),o()(t,"resourceObj",{place_id:"",class_id:"",placeName:"",source:""}),o()(t,"monitorTimer",null),o()(t,"monitorImg",""),t},methods:{hideToast:function(){this.isToast=!1},resizeLayout:function(){setTimeout(function(){var t=$(".index .m-right").height(),e=$(".m-right .inner-top").height(),n=t-e-40;$(".m-right .inner-content").height(n)},100)},handleNodeClick:function(t,e){var n=this;if(t.id!=this.resourceObj.place_id&&1==t.is_leaf){var i={placeName:t.label,place_id:t.id,class_id:t.cid,source:this.resourceObj.source};$(".span").removeClass("custom-tree-node"),this.$refs[t.id].classList.add("custom-tree-node"),this.resourceObj=i,this.$router.replace({path:"/CardMonitor",query:i}),window.clearInterval(this.monitorTimer),this.monitorTimer=setInterval(function(){n.getCardMonitor(i.class_id,i.place_id)},1e3)}},back:function(){this.$router.push("/"+this.$route.query.source)},getCardMonitor:function(t,e){var n=this,i={school_id:localStorage.getItem("schoolId"),user_id:localStorage.getItem("userId")};t?i.class_id=t:e&&(i.place_id=e),this.$api.DeviceControl.getCardMonitor("post",i).then(function(t){n.monitorImg=t.data.screenshot}).catch(function(t){n.tableLoading=!1})},getPlaceTree:function(){var t=this,e={school_id:localStorage.getItem("schoolId")};this.$api.Common.getPlaceTree("get",e).then(function(e){if(600==e.data.code||0==e.data.code){if(t.treeData=e.data.data,t.resourceObj.place_id)$(".span").removeClass("custom-tree-node"),t.$refs[t.resourceObj.place_id].classList.add("custom-tree-node"),window.clearInterval(t.monitorTimer),t.monitorTimer=setInterval(function(){t.getCardMonitor(t.resourceObj.class_id,t.resourceObj.place_id)},1e3);else if(t.treeData.length>0&&t.treeData[0].children&&t.treeData[0].children.length>0){var n=t.treeData[0].children[0];t.$refs[n.id].classList.add("custom-tree-node"),t.resourceObj.placeName=n.label,t.resourceObj.place_id=n.id}}else t.isToast=!0,t.toast=e.data.msg}).catch(function(e){t.tableLoading=!1})}},mounted:function(){this.roleActions=this.$store.state.Common.roleActions,this.resizeLayout(),this.resourceObj=this.$route.query,this.getPlaceTree()},created:function(){}},c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card-monitor"},[n("div",{staticClass:"m-left"},[n("el-tree",{attrs:{data:t.treeData,"node-key":"id","default-checked-keys":["10010"],"check-on-click-node":!0,"default-expand-all":""},on:{"node-click":t.handleNodeClick},scopedSlots:t._u([{key:"default",fn:function(e){var i=(e.node,e.data);return n("span",{ref:i.id,staticClass:"span"},[t._v(t._s(i.label))])}}])})],1),t._v(" "),n("div",{staticClass:"m-right"},[n("div",{staticClass:"inner-top"},[n("Button",{attrs:{btnClass:"custom6",iconLeft:!0,data:t.btn2Data,btnFontSize:"12px",title:"返回上一页"},on:{click:t.back}}),t._v(" "),n("h4",[t._v(t._s(t.resourceObj.placeName))])],1),t._v(" "),n("div",{staticClass:"inner-content"},[n("div",{staticClass:"inner-img"},[n("img",{attrs:{src:t.monitorImg,alt:""}})])])]),t._v(" "),t.isToast?n("Toast",{attrs:{"modal-title":t.toast,duration:"1500"},on:{toastCancel:t.hideToast}}):t._e()],1)},l=[],h={render:c,staticRenderFns:l},u=h,m=n("VU/8"),p=i,f=m(d,u,!1,p,"data-v-25606c9d",null);e.default=f.exports},jvYm:function(t,e,n){var i=n("t8Hw");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n("rjj0")("0402c2d2",i,!0,{})},t8Hw:function(t,e,n){e=t.exports=n("FZ+f")(!1),e.push([t.i,"\n.card-monitor[data-v-25606c9d] {\n  width: 100%;\n  height: 100%;\n  margin: 0 auto;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  text-align: center;\n  overflow: hidden;\n  background-color: #E7E8EB;\n}\n.card-monitor .m-left[data-v-25606c9d] {\n    -ms-flex-preferred-size: 260px;\n        flex-basis: 260px;\n    min-width: 260px;\n    text-align: center;\n    background-color: #fff;\n    padding: 30px 0 30px 40px;\n    font-size: 12px;\n    overflow: hidden;\n    overflow-y: auto;\n}\n.card-monitor .m-left .span[data-v-25606c9d] {\n      padding: 5px 20px;\n}\n.card-monitor .m-left .custom-tree-node[data-v-25606c9d] {\n      background-color: #1cab7d;\n      color: #fff;\n}\n.card-monitor .m-right[data-v-25606c9d] {\n    height: auto;\n    -webkit-box-flex: 1;\n        -ms-flex: 1;\n            flex: 1;\n    text-align: left;\n    background-color: #fff;\n    position: relative;\n}\n.card-monitor .m-right .button-div[data-v-25606c9d] {\n      position: absolute;\n      right: 30px;\n      top: 30px;\n}\n.card-monitor .m-right .inner-top[data-v-25606c9d] {\n      line-height: 100px;\n      height: 100px;\n      text-align: center;\n}\n.card-monitor .m-right .inner-top h4[data-v-25606c9d] {\n        font-size: 20px;\n        font-weight: bold;\n}\n.card-monitor .m-right .inner-content[data-v-25606c9d] {\n      width: 90%;\n      margin: 0 auto;\n      overflow: hidden;\n}\n.card-monitor .m-right .inner-content .inner-img[data-v-25606c9d] {\n        position: relative;\n        width: 100%;\n        height: 100%;\n}\n.card-monitor .m-right .inner-content .inner-img img[data-v-25606c9d] {\n          width: 100%;\n          height: 100%;\n          max-width: 100%;\n          max-height: 100%;\n          position: absolute;\n          left: 0;\n          top: 0;\n          bottom: 0;\n          right: 0;\n          margin: auto;\n}\n",""])}});