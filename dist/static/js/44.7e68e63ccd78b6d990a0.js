webpackJsonp([44],{AGhh:function(o,e,a){e=o.exports=a("FZ+f")(!1),e.push([o.i,"\n.upload-word[data-v-4523c918] {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n}\n.upload-word .upload-top[data-v-4523c918] {\n    min-height: 6vh;\n    height: 6vh;\n    line-height: 6vh;\n    background-color: #fff;\n    border-bottom: 1px solid #E7E8EB;\n    overflow: hidden;\n}\n.upload-word .upload-top h4[data-v-4523c918] {\n      font-size: 16px;\n      font-weight: bold;\n      display: inline-block;\n      margin-left: 30px;\n}\n.upload-word .upload-top .button-div[data-v-4523c918] {\n      float: right;\n      margin-right: 20px;\n      margin-top: 9px;\n}\n.upload-word .upload-content[data-v-4523c918] {\n    width: 100%;\n    height: 100%;\n    text-align: center;\n    background-color: #fff;\n    padding-right: 10%;\n    overflow: hidden;\n}\n.upload-word .upload-content[data-v-4523c918] .el-form {\n      margin-top: 30px;\n      margin-right: 10%;\n}\n.upload-word .upload-content[data-v-4523c918] .el-form .el-form-item {\n        text-align: left;\n}\n.upload-word .upload-content[data-v-4523c918] .el-form .el-form-item .button-div {\n          margin-top: 0;\n          margin-left: 20px;\n}\n.upload-word .upload-content[data-v-4523c918] .el-form .el-form-item .el-textarea__inner {\n          padding: 10px 15px 30px;\n}\n.upload-word .upload-content[data-v-4523c918] .el-form .el-form-item .limit {\n          position: absolute;\n          right: 15px;\n          bottom: 10px;\n          z-index: 1;\n          font-size: 12px;\n          line-height: 16px;\n          color: #cfcfcf;\n}\n.upload-word .upload-content[data-v-4523c918] .el-form .el-checkbox {\n        height: 30px;\n        line-height: 30px;\n}\n.upload-word .upload-content[data-v-4523c918] .el-form .el-checkbox .el-checkbox__inner {\n          border-radius: 50% !important;\n}\n.upload-word .upload-content[data-v-4523c918] .el-form .el-checkbox .el-checkbox__label {\n          color: #333 !important;\n}\n.upload-word .upload-content .button-div[data-v-4523c918]:nth-of-type(1) {\n      margin-top: 3vh;\n      margin-right: 20px;\n}\n.upload-word .upload-content .button-div[data-v-4523c918]:nth-of-type(2) {\n      margin-top: 3vh;\n      margin-left: 20px;\n}\n.upload-word .sch-system-dialog[data-v-4523c918] .el-dialog {\n    /*margin-top: 8vh!important;*/\n}\n.upload-word .sch-system-dialog[data-v-4523c918] .el-dialog .el-dialog__body {\n      padding: 15px 25px 10px !important;\n}\n.upload-word .sch-system-dialog[data-v-4523c918] .el-dialog .el-dialog__body .checked-box .el-checkbox {\n        margin-left: 100px;\n        margin-top: 10px;\n}\n.upload-word .sch-system-dialog[data-v-4523c918] .el-dialog .el-dialog__body .checked-box .el-checkbox .el-checkbox__inner {\n          border-radius: 50% !important;\n}\n.upload-word .sch-system-dialog[data-v-4523c918] .el-dialog .el-dialog__body .checked-box .el-checkbox .el-checkbox__label {\n          color: #333 !important;\n}\n.upload-word .sch-system-dialog[data-v-4523c918] .el-dialog .el-dialog__body .checked-box .el-checkbox:nth-of-type(1) {\n          margin-left: 378px;\n}\n.upload-word .sch-system-dialog[data-v-4523c918] .el-dialog .el-dialog__footer .dialog-footer {\n      margin: 0 auto;\n      text-align: center;\n}\n.upload-word .sch-system-dialog[data-v-4523c918] .el-dialog .el-dialog__footer .dialog-footer .button-div {\n        clear: both;\n        float: none;\n        margin-right: 20px;\n}\n.upload-word .upload-dialog[data-v-4523c918] .el-dialog {\n    margin-top: 15vh !important;\n}\n.upload-word .upload-dialog[data-v-4523c918] .el-dialog .el-dialog__body {\n      padding-bottom: 0;\n}\n.upload-word .upload-dialog[data-v-4523c918] .el-dialog .el-dialog__body .el-form {\n        text-align: left;\n}\n.upload-word .upload-dialog[data-v-4523c918] .el-dialog .el-dialog__body .el-form .el-form-item {\n          padding-bottom: 0 !important;\n}\n.upload-word .upload-dialog[data-v-4523c918] .el-dialog .el-dialog__body .el-form .el-form-item__error {\n          padding-top: 0;\n}\n.upload-word .upload-dialog[data-v-4523c918] .el-dialog .el-dialog__body .el-form .el-checkbox {\n          height: 30px;\n          line-height: 30px;\n}\n.upload-word .upload-dialog[data-v-4523c918] .el-dialog .el-dialog__body .el-form .el-checkbox .el-checkbox__inner {\n            border-radius: 50% !important;\n}\n.upload-word .upload-dialog[data-v-4523c918] .el-dialog .el-dialog__body .el-form .el-checkbox .el-checkbox__label {\n            color: #333 !important;\n}\n.upload-word .upload-dialog[data-v-4523c918] .el-dialog .el-dialog__body .el-form .button-div {\n          width: 100px;\n          margin-left: 10px;\n          margin-right: 0 !important;\n}\n.upload-word .upload-dialog[data-v-4523c918] .el-dialog .el-dialog__body .upload-box {\n        margin: 0 auto;\n        width: 470px;\n        margin-top: 2px;\n        margin-bottom: 20px;\n}\n.upload-word .upload-dialog[data-v-4523c918] .el-dialog .el-dialog__body .upload-box .el-upload {\n          width: 100%;\n}\n.upload-word .upload-dialog[data-v-4523c918] .el-dialog .el-dialog__body .upload-box .el-upload .el-upload-dragger {\n            width: 100%;\n            height: 180px;\n}\n.upload-word .upload-dialog[data-v-4523c918] .el-dialog .el-dialog__body .upload-box .el-upload .el-upload-dragger:hover {\n              border-color: #1cab7d;\n}\n.upload-word .upload-dialog[data-v-4523c918] .el-dialog .el-dialog__body .upload-box .el-upload .el-upload-dragger:focus {\n              outline: none;\n}\n.upload-word .upload-dialog[data-v-4523c918] .el-dialog .el-dialog__body .upload-box .el-upload .el-upload-dragger .button-div {\n              margin-top: 45px;\n              margin-bottom: 20px;\n}\n.upload-word .upload-dialog[data-v-4523c918] .el-dialog /deep/ .el-dialog__footer .dialog-footer {\n      margin: 0 auto;\n      display: block;\n      padding-right: 10px;\n      text-align: left;\n      overflow: hidden;\n      text-align: center;\n}\n.upload-word .upload-dialog[data-v-4523c918] .el-dialog /deep/ .el-dialog__footer .dialog-footer .button-div {\n        width: 100px;\n        margin-left: 20px;\n        margin-right: 0 !important;\n}\n.upload-word .upload-success[data-v-4523c918] .el-dialog {\n    margin-top: 35vh !important;\n}\n.upload-word .upload-success[data-v-4523c918] .el-dialog .el-dialog__header {\n      padding: 30px 20px 20px;\n}\n.upload-word .upload-success[data-v-4523c918] .el-dialog .el-dialog__header .el-dialog__title {\n        font-size: 30px;\n        font-weight: normal;\n}\n.upload-word .upload-success[data-v-4523c918] .el-dialog .el-dialog__body {\n      padding: 15px 25px 10px !important;\n      border: 0;\n      text-align: center;\n}\n.upload-word .upload-success[data-v-4523c918] .el-dialog .el-dialog__body .button-div {\n        clear: both;\n        float: none;\n        margin-left: 20px;\n}\n.upload-word .upload-success[data-v-4523c918] .el-dialog .el-dialog__body .button-div:nth-of-type(1) {\n          margin-left: 0;\n}\n.upload-word .upload-success[data-v-4523c918] .el-dialog .el-dialog__body .el-checkbox {\n        margin-top: 20px;\n}\n.upload-word .upload-success[data-v-4523c918] .el-dialog .el-dialog__body .el-checkbox:nth-of-type(1) {\n          margin-right: 40px;\n}\n.upload-word .upload-success[data-v-4523c918] .el-dialog .el-dialog__body .el-checkbox .el-checkbox__inner {\n          border-radius: 50% !important;\n}\n.upload-word .upload-success[data-v-4523c918] .el-dialog .el-dialog__body .el-checkbox .el-checkbox__label {\n          color: #333 !important;\n}\n",""])},Bycv:function(o,e,a){"use strict";function t(o){a("FCmw")}Object.defineProperty(e,"__esModule",{value:!0});var l=a("mvHQ"),d=a.n(l),i=a("bWJ8"),n=a("T0Gs"),r=a("qqG0"),s={name:"UploadWord",components:{Button:i.a,treeTransfer:n.a,Toast:r.a},computed:{defaultErrImg:function(){return'this.src="'+this.$store.state.Common.defaultErrImg+'"'}},data:function(){return{isToast:!1,toast:"",choosePlaceDialog:!1,listClassroom:[],fromData:[{id:1e3,pid:101,label:"烟台一中",group:102,disabled:0,children:[{id:1e4,pid:1e3,label:"校门口",disabled:0,group:103,children:[{id:10010,pid:1e4,label:"101",disabled:0,group:104,children:[]},{id:10011,pid:1e4,label:"102",disabled:0,group:104,children:[]},{id:10012,pid:1e4,label:"103",disabled:0,group:104,children:[]}]},{id:10001,pid:1e3,label:"传达室",disabled:0,group:103,children:[{id:10020,pid:10001,label:"201",disabled:0,group:104,children:[]},{id:10021,pid:10001,label:"202",disabled:0,group:104,children:[]},{id:10022,pid:10001,label:"203",disabled:0,group:104,children:[]}]}]}],btn2Data:{iconL:a("KcoX"),iconLAct:a("0Qjn")},addDialog:!1,addForm:{label_name:"",label_id:0,is_share:!1},rules:{title:[{required:!0,message:"请输入标题",trigger:"blur"}],doc_content:[{required:!0,message:"请输入内容",trigger:"blur"}],sourceName:[{required:!0,message:"请输入资源名称",trigger:"blur"}],label_name:[{required:!0,message:"请输入资源库名称",trigger:"blur"}],label_id:[{required:!0,message:"请选择资源库",trigger:"change"}]},publishSuccessDialog:!1,uploadSuccessDialog:!1,toCard:!0,toParent:!1,userLabels:[],uploadParams:{},fileList:[],addWrodForm:{label_name:"",label_id:"",is_share:!1,title:"",doc_content:""}}},methods:{resizeLayout:function(){setTimeout(function(){var o=$(".index > .m-cen").height(),e=$(".upload-word > .upload-top").height(),a=o-e;$(".upload-word .upload-content").height(a)},50)},back:function(){this.$router.go(-1)},addClick:function(){var o=this;this.addDialog=!0,this.addForm={label_name:"",label_id:0,is_share:!1},setTimeout(function(){o.$refs.addForm.resetFields()},20)},changeShare:function(o){var e=this;setTimeout(function(){e.$refs.addWrodForm.clearValidate(["label_id"])})},saveAddResource:function(){var o=this;this.$refs.addForm.validate(function(e){if(!e)return o.$message({message:"请输入内容（*为必填项）",type:"error",duration:o.msgDuration}),!1;var a={label_name:o.addForm.label_name,is_share:o.addForm.is_share?1:0,resource_type:3,user_id:localStorage.getItem("userId"),school_id:localStorage.getItem("schoolId")};o.$api.Rules.modifyLabel("post",a).then(function(e){600==e.data.code||0==e.data.code?(o.addDialog=!1,o.addWrodForm.label_id=e.data.data.id,o.addWrodForm.is_share=1==e.data.data.is_share,o.getUserLabels()):(o.isToast=!0,o.toast=e.data.msg)})})},beforeUpload:function(o){},changeUpload:function(o,e){var a="image/jpeg"===o.raw.type,t="image/gif"===o.raw.type,l="image/png"===o.raw.type,d=o.size/1024/1024<2,i=o.raw.name.toLowerCase().split("."),n=[],r=!1;i.length>0&&(n=i[i.length-1],r="rar"==n),a||t||l||r||this.$message({showClose:!0,type:"warning",message:"只能上传rar、jpg、png、静态gif图片!",duration:this.msgDuration}),d||this.$message({showClose:!0,type:"warning",message:"上传图片大小不能超过 20MB!",duration:this.msgDuration}),(a||t||l)&&d||e.forEach(function(a,t){a.uid==o.uid&&e.splice(t,1)})},uploadSuccess:function(o,e,a){this.uploadSuccessDialog=!0},uploadError:function(o,e,a){},saveUpload:function(){var o=this;this.resourceList=[],this.$refs.addWrodForm.validate(function(e){if(!e)return o.$message({message:"请输入内容（*为必填项）",type:"error",duration:o.msgDuration}),!1;var a={resource_type:3,label_id:o.addWrodForm.label_id,is_share:o.addWrodForm.is_share?1:0,title:o.addWrodForm.title,doc_content:o.addWrodForm.doc_content,school_id:localStorage.getItem("schoolId")};o.$api.Rules.addResource("post",a).then(function(e){o.$loading().close(),600==e.data.code||0==e.data.code?(o.uploadSuccessDialog=!0,o.$refs.addWrodForm.resetFields(),o.resourceList=e.data.data,o.getPlaceTree()):(o.isToast=!0,o.toast=e.data.msg)}).catch(function(e){o.$loading().close()})})},getSelected:function(o){for(var e=0;e<o.length;e++)this.listClassroom.push({classId:o[e].pid,placeName:o[e].pname,studentId:o[e].id,id:o[e].id,buildingName:o[e].label});var a=this.listClassroom.length;if(1!=a)for(var t=0;t<a;t++)for(var l=t+1;l<a;l++)this.listClassroom[l].id==this.listClassroom[t].id&&(this.listClassroom.splice(l,1),a--,l--)},checkedClick:function(o){this.listClassroom.push({classId:o.pid,placeName:o.pname,studentId:o.id,id:o.id,buildingName:o.value});var e=this.listClassroom.length;if(1!=e)for(var a=0;a<e;a++)for(var t=a+1;t<e;t++)this.listClassroom[t].id==this.listClassroom[a].id&&(this.listClassroom.splice(t,1),e--,t--)},delResource:function(){var o=this;this.$confirm("这个资源库内所有文档都将被删除！同时删除班牌正在使用的资源！确定删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.editDialog=!1,o.checkedResource={},o.$message({showClose:!0,type:"success",message:"删除成功!",duration:o.msgDuration})}).catch(function(){})},getUserLabels:function(){var o=this,e={resource_type:3,user_id:localStorage.getItem("userId"),school_id:localStorage.getItem("schoolId")};this.$api.Rules.getUserLabels("get",e).then(function(e){600==e.data.code||0==e.data.code?o.userLabels=e.data.data.rows:(o.isToast=!0,o.toast=e.data.msg)})},publishResource:function(){var o=this,e=this.listClassroom.map(function(o){return o.id}),a={school_id:localStorage.getItem("schoolId"),resource_id:this.resourceList.id,resource_type:3,class_id:-1,place_id:e.join(","),is_show_parent:this.toParent?1:0,is_show_device:this.toCard?1:0,user_id:localStorage.getItem("userId")};this.$loading(),this.$api.Rules.publishResource("post",a).then(function(e){o.$loading().close(),600==e.data.code||0==e.data.code?(o.$message({showClose:!0,type:"success",message:"发布成功",duration:o.msgDuration}),o.choosePlaceDialog=!1,o.uploadSuccessDialog=!1):(o.isToast=!0,o.toast=e.data.msg)}).catch(function(e){o.$loading().close()})},getPlaceTree:function(){var o=this,e={school_id:localStorage.getItem("schoolId")};this.$api.Common.getPlaceTree("get",e).then(function(e){600==e.data.code||0==e.data.code?o.fromData=e.data.data:(o.isToast=!0,o.toast=e.data.msg)}).catch(function(e){o.tableLoading=!1})}},mounted:function(){this.roleActions=this.$store.state.Common.roleActions,this.resizeLayout()},created:function(){"{}"!=d()(this.$route.query)&&localStorage.setItem("routeParams",d()(this.$route.query)),this.getUserLabels()}},c=function(){var o=this,e=o.$createElement,a=o._self._c||e;return a("div",{staticClass:"upload-word"},[a("div",{staticClass:"upload-top"},[a("h4",[o._v("上传文档")]),o._v(" "),a("Button",{attrs:{btnClass:"custom6",iconLeft:!0,data:o.btn2Data,btnFontSize:"12px",btnHeight:"38px",title:"返回上一页"},on:{click:o.back}})],1),o._v(" "),a("div",{staticClass:"upload-content"},[a("el-form",{ref:"addWrodForm",attrs:{"label-width":"100px",rules:o.rules,model:o.addWrodForm}},[a("el-form-item",{attrs:{label:"资源库：",prop:"label_id"}},[a("el-select",{attrs:{placeholder:"请选择资源库"},model:{value:o.addWrodForm.label_id,callback:function(e){o.$set(o.addWrodForm,"label_id",e)},expression:"addWrodForm.label_id"}},o._l(o.userLabels,function(o){return a("el-option",{key:o.id,attrs:{label:o.label_name,value:o.id}})}),1),o._v(" "),a("Button",{attrs:{btnClass:"custom11",btnFontSize:"12px",title:"+添加"},on:{click:o.addClick}}),o._v(" "),a("br"),o._v(" "),a("el-checkbox",{on:{change:o.changeShare},model:{value:o.addWrodForm.is_share,callback:function(e){o.$set(o.addWrodForm,"is_share",e)},expression:"addWrodForm.is_share"}},[o._v("共享")])],1),o._v(" "),a("el-form-item",{attrs:{label:"标题：",prop:"title"}},[a("el-input",{staticStyle:{width:"305px"},attrs:{maxlength:"20",clearable:"",placeholder:"请输入标题"},model:{value:o.addWrodForm.title,callback:function(e){o.$set(o.addWrodForm,"title",e)},expression:"addWrodForm.title"}})],1),o._v(" "),a("el-form-item",{attrs:{label:"内容：",prop:"doc_content"}},[a("el-input",{attrs:{type:"textarea",rows:15,maxlength:"1000",placeholder:"请输入内容..."},model:{value:o.addWrodForm.doc_content,callback:function(e){o.$set(o.addWrodForm,"doc_content",e)},expression:"addWrodForm.doc_content"}}),o._v(" "),a("span",{staticClass:"limit"},[o._v(o._s(o.addWrodForm.doc_content.length)+"/1000")])],1)],1),o._v(" "),a("Button",{attrs:{title:"取消",btnClass:"custom7",btnFontSize:"12px",btnHeight:"4.5vh"},on:{click:o.back}}),o._v(" "),a("Button",{attrs:{title:"保存",btnClass:"custom8",btnFontSize:"12px",btnHeight:"4.5vh"},on:{click:o.saveUpload}})],1),o._v(" "),a("el-dialog",{staticClass:"upload-dialog",attrs:{title:"新建资源库",visible:o.addDialog,width:"500px",center:""},on:{"update:visible":function(e){o.addDialog=e}}},[a("div",{staticClass:"content"},[a("el-form",{ref:"addForm",attrs:{"label-width":"100px",rules:o.rules,model:o.addForm}},[a("el-form-item",{attrs:{label:"资源库名称：",prop:"label_name"}},[a("el-input",{staticStyle:{width:"230px"},attrs:{placeholder:"请输入资源库名称",clearable:""},model:{value:o.addForm.label_name,callback:function(e){o.$set(o.addForm,"label_name",e)},expression:"addForm.label_name"}})],1),o._v(" "),a("el-form-item",{attrs:{label:"资源库共享："}},[a("el-checkbox",{model:{value:o.addForm.is_share,callback:function(e){o.$set(o.addForm,"is_share",e)},expression:"addForm.is_share"}},[o._v("共享")])],1)],1)],1),o._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{title:"取消",btnClass:"custom7",btnFontSize:"12px",btnHeight:"4.5vh"},on:{click:function(e){o.addDialog=!1}}}),o._v(" "),a("Button",{attrs:{title:"保存",btnClass:"custom8",btnFontSize:"12px",btnHeight:"4.5vh"},on:{click:o.saveAddResource}})],1)]),o._v(" "),a("el-dialog",{staticClass:"sch-system-dialog",attrs:{title:"发布到班牌",visible:o.choosePlaceDialog,width:"900px",center:""},on:{"update:visible":function(e){o.choosePlaceDialog=e}}},[a("div",{staticClass:"content"},[a("div",{staticClass:"transfer-div"},[a("tree-transfer",{attrs:{from_data:o.fromData,leftTitle:"选择场所/教室",leftplaceholder:"请输入场所/教室名称",sourceDiffer:"2",user_data:o.listClassroom},on:{showSelected:o.getSelected,checkedClick:o.checkedClick}}),o._v(" "),a("div",{staticClass:"checked-box"},[a("el-checkbox",{model:{value:o.toCard,callback:function(e){o.toCard=e},expression:"toCard"}},[o._v("发布到班牌")]),o._v(" "),a("el-checkbox",{model:{value:o.toParent,callback:function(e){o.toParent=e},expression:"toParent"}},[o._v("发布家长端")])],1)],1)]),o._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{title:"取消",btnClass:"custom7",btnFontSize:"12px",btnHeight:"40px"},on:{click:function(e){o.choosePlaceDialog=!1}}}),o._v(" "),a("Button",{attrs:{title:"保存",btnClass:"custom8",btnFontSize:"12px",btnHeight:"40px"},on:{click:o.publishResource}})],1)]),o._v(" "),a("el-dialog",{staticClass:"upload-success",attrs:{title:"上传完成",visible:o.uploadSuccessDialog,width:"400px",center:""},on:{"update:visible":function(e){o.uploadSuccessDialog=e}}},[o.roleNos.indexOf("S01")>-1?a("Button",{attrs:{title:"暂不发布",btnClass:"custom7",btnFontSize:"12px",btnHeight:"40px"},on:{click:function(e){o.uploadSuccessDialog=!1}}}):o._e(),o._v(" "),o.roleNos.indexOf("S01")>-1?a("Button",{attrs:{title:"发布文档",btnClass:"custom8",btnFontSize:"12px",btnHeight:"40px"},on:{click:function(e){o.choosePlaceDialog=!0}}}):o._e(),o._v(" "),-1==o.roleNos.indexOf("S01")?a("Button",{attrs:{title:"发布文档",btnClass:"custom8",btnFontSize:"12px",btnHeight:"40px"},on:{click:o.publishResource}}):o._e(),o._v(" "),a("br"),o._v(" "),-1==o.roleNos.indexOf("S01")?a("el-checkbox",{model:{value:o.toCard,callback:function(e){o.toCard=e},expression:"toCard"}},[o._v("发布到班牌")]):o._e(),o._v(" "),-1==o.roleNos.indexOf("S01")?a("el-checkbox",{model:{value:o.toParent,callback:function(e){o.toParent=e},expression:"toParent"}},[o._v("分享到家长端")]):o._e()],1),o._v(" "),a("el-dialog",{staticClass:"upload-success",attrs:{title:"发布完成",visible:o.publishSuccessDialog,width:"400px",center:""},on:{"update:visible":function(e){o.publishSuccessDialog=e}}},[a("Button",{attrs:{title:"暂不发布",btnClass:"custom7",btnFontSize:"12px",btnHeight:"40px"},on:{click:function(e){o.publishSuccessDialog=!1}}}),o._v(" "),a("Button",{attrs:{title:"发布到家长端",btnClass:"custom8",btnFontSize:"12px",btnHeight:"40px"},on:{click:function(e){o.publishSuccessDialog=!1}}})],1)],1)},u=[],p={render:c,staticRenderFns:u},g=p,h=a("VU/8"),m=t,b=h(s,g,!1,m,"data-v-4523c918",null);e.default=b.exports},FCmw:function(o,e,a){var t=a("AGhh");"string"==typeof t&&(t=[[o.i,t,""]]),t.locals&&(o.exports=t.locals);a("rjj0")("a166d952",t,!0,{})}});