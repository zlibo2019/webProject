webpackJsonp([62],{"/WPx":function(e,t,a){"use strict";function o(e){a("/jDi")}Object.defineProperty(t,"__esModule",{value:!0});var n=a("mvHQ"),i=a.n(n),s=a("bWJ8"),l=a("qqG0"),r={name:"SelectCourseManage",components:{Button:s.a,Toast:l.a},data:function(){return{defArrow:this.$store.state.Common.defaultLineArrow,isToast:!1,toast:"",tableLoading:!1,tableData:[],allNum:0,currentPage:1,pageItem:20,rules:{courseType:[{required:!0,message:"请选择走班课程",trigger:"change"}],grade:[{required:!0,message:"请选择年级",trigger:"blur"}],cousrseCount:[{required:!0,message:"请选择走班课程数量",trigger:"change"}],semesterType:[{type:"array",required:!0,message:"请选择学期",trigger:"change"}],name:[{required:!0,message:"请输入课程名称",trigger:"blur"}]},courseData:[],gradeData:[{id:"1",name:"一年级"},{id:"2",name:"二年级"},{id:"3",name:"三年级"}],teacherData:[{id:"1",name:"张三"},{id:"2",name:"李四"},{id:"3",name:"三年级"}],courseName:"",gradeName:"",selectFormDialog:!1,selectForm:{courseType:"",grade:0,cousrseCount:"",teacher:""},courseFormDialog:!1,courseForm:{name:"",remarks:""},grade:0,subjectId:0,classfiedSubjectName:""}},methods:{hideToast:function(){this.isToast=!1},handleCurrentChange:function(e){this.currentPage=e},resizeLayout:function(){setTimeout(function(){var e=$(".index > .m-cen").height(),t=$(".index .education-top").height(),a=$(".index .term-top").height(),o=$(".pagination-box").height(),n=e-t-a-o-10;$(".select-course-manage .table-box").height(n)},50)},getTableData:function(){var e=this,t={school_id:localStorage.getItem("schoolId")};this.tableLoading=!0,this.$api.EducationManage.getClassfiedSubject("get",t).then(function(t){e.tableLoading=!1,600==t.data.code||0==t.data.code?(e.tableData=t.data.data,e.allNum=t.data.total_record):(e.isToast=!0,e.toast=t.data.msg)}).catch(function(t){e.tableLoading=!1})},btnClick:function(e){var t=this;this.selectFormDialog=!0,this.selectForm={courseType:"",grade:"",cousrseCount:"",courseData:[]},setTimeout(function(){t.$refs.selectForm.resetFields(),e&&(t.selectForm=JSON.parse(i()(e)),t.selectForm.title="修改走班课程")},20),e||(this.selectForm.title="新建走班课程")},addCourse:function(){var e=this;this.courseFormDialog=!0,this.courseForm={name:"",remarks:""},this.courseForm.title="新建课程",setTimeout(function(){e.$refs.courseForm.resetFields()},20)},postClassfiedSubject:function(){for(var e=this,t=[],a=0;a<this.selectForm.courseData.length;a++)t.push({classfied_subject_name:this.selectForm.courseData[a].courseName,teacher_id:this.selectForm.courseData[a].teacherName});var o={school_id:localStorage.getItem("schoolId"),grade_id:this.selectForm.grade,subject_id:this.selectForm.courseType,classfied_subject_teacher:t};this.$api.EducationManage.postClassfiedSubject("post",o).then(function(t){e.tableLoading=!1,600==t.data.code||0==t.data.code?e.getTableData():(e.isToast=!0,e.toast=t.data.msg)}).catch(function(t){e.tableLoading=!1})},loadClassfiedSubjectById:function(){var e=this,t={school_id:localStorage.getItem("schoolId"),id:1};this.$api.EducationManage.loadClassfiedSubjectById("get",t).then(function(t){e.tableLoading=!1,600==t.data.code||0==t.data.code?e.getTableData():(e.isToast=!0,e.toast=t.data.msg)}).catch(function(t){e.tableLoading=!1})},putClassfiedSubjectById:function(){var e=this,t={teacher_id:3,name:"走班课程名称"};this.$api.EducationManage.putClassfiedSubjectById("put",t).then(function(t){e.tableLoading=!1,600==t.data.code||0==t.data.code?e.getTableData():(e.isToast=!0,e.toast=t.data.msg)}).catch(function(t){e.tableLoading=!1})},deleteClassfiedSubjectById:function(e){var t=this,a={id:e};this.$api.EducationManage.deleteClassfiedSubjectById("delete",a).then(function(e){t.tableLoading=!1,600==e.data.code||0==e.data.code?t.getTableData():(t.isToast=!0,t.toast=e.data.msg)}).catch(function(e){t.tableLoading=!1})},saveClassfiedSubjectClick:function(){var e=this;this.$refs.selectForm.validate(function(t){t?(e.selectFormDialog=!1,e.postClassfiedSubject()):e.$message({message:"请输入内容（*为必填项）",type:"error",duration:e.msgDuration})})},saveBtnClick:function(){var e=this;this.$refs.selectForm.validate(function(t){if(!t)return e.$message({message:"请输入内容（*为必填项）",type:"error",duration:e.msgDuration}),!1;e.selectFormDialog=!1})},delClick:function(e){var t=this;this.$confirm('删除所选的"走班课程"后，与此相关联的"教师任课关系"与所有"排课关系"，将同步删除，是否继续?',"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.deleteClassfiedSubjectById(e.id),t.$loading(),setTimeout(function(){t.$loading().close()},1e3)}).catch(function(){})},handleChange:function(e){if(e>this.selectForm.courseData.length)for(var t=this.selectForm.courseData.length;t<e;t++)this.selectForm.courseData.push({courseName:this.selectForm.grade||this.courseName?""+(this.selectForm.grade?this.selectForm.grade:"")+(this.courseName?this.courseName:"")+(t+1):"",teacherName:this.teacherName});else if(e<this.selectForm.courseData.length)for(var a=this.selectForm.courseData.length;a>=e;a--)this.selectForm.courseData.splice(a,1)},changeCourseType:function(e){var t=this;this.courseData.forEach(function(a){if(a.id==e)return t.courseName=a.name})},changeTeacher:function(e){var t=this;this.teacherData.forEach(function(a){if(a.id==e)return t.teacherName=a.name})},changeGrade:function(e){var t=this;this.gradeData.forEach(function(a){if(a.id==e)return t.gradeName=a.name})},getCourse:function(){var e=this,t={schoolid:localStorage.getItem("schoolId")};this.tableLoading=!0,this.$api.EducationManage.getCourse("get",t).then(function(t){e.tableLoading=!1,600==t.data.code||0==t.data.code?e.courseData=t.data.data:(e.isToast=!0,e.toast=t.data.msg)}).catch(function(t){e.tableLoading=!1})},postCourse:function(){var e=this,t={name:this.courseForm.name,remarks:this.courseForm.remarks,schoolid:localStorage.getItem("schoolId")};this.$api.EducationManage.postCourse("post",t).then(function(t){e.tableLoading=!1,600==t.data.code||0==t.data.code?e.getCourse():(e.isToast=!0,e.toast=t.data.msg)}).catch(function(t){e.tableLoading=!1})}},mounted:function(){this.roleActions=this.$store.state.Common.roleActions,this.resizeLayout()},created:function(){this.getTableData(),this.getCourse()}},c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"select-course-manage"},[a("div",{staticClass:"term-top"},[a("dd",[e._v("\n        走班课程\n        "),a("span",[e._v("("+e._s(e.tableData.length)+")")])]),e._v(" "),a("Button",{attrs:{title:"新建走班课程",btnClass:"custom8",btnFontSize:"12px"},on:{click:e.btnClick}})],1),e._v(" "),a("div",{staticClass:"table-box"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{id:"table",height:"100%",border:"",align:"center",data:e.tableData,"tooltip-effect":"dark","highlight-current-row":""}},[a("el-table-column",{attrs:{type:"index",label:"序号","min-width":"80",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"subject_name",label:"课程类型","min-width":"100","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"classfied_subject_name",label:"走班课程名称","min-width":"130","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"teacher_name",label:"任课教师","min-width":"100","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"normal",attrs:{size:"mini",plain:""},on:{click:function(a){return e.btnClick(t.row)}}},[e._v("走班学生管理")]),e._v(" "),a("el-button",{staticClass:"normal",attrs:{size:"mini",plain:""},on:{click:function(a){return e.btnClick(t.row)}}},[e._v("修改")]),e._v(" "),a("el-button",{staticClass:"warning",attrs:{size:"mini",plain:""},on:{click:function(a){return e.delClick(t.row)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),a("div",{staticClass:"pagination-box"},[a("el-pagination",{attrs:{background:"",layout:" prev, pager, next",total:e.allNum,"page-size":e.pageItem,"current-page":e.currentPage},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{staticClass:"member-dialog",attrs:{title:e.selectForm.title,visible:e.selectFormDialog,width:"800px",center:""},on:{"update:visible":function(t){e.selectFormDialog=t}}},[a("div",{staticClass:"content"},[a("el-form",{ref:"selectForm",attrs:{"label-width":"110px",rules:e.rules,model:e.selectForm}},[a("el-form-item",{attrs:{label:"走班课程类型：",prop:"courseType"}},[a("el-select",{staticStyle:{width:"250px"},attrs:{placeholder:"请选择走班课程",size:"medium"},on:{change:e.changeCourseType},model:{value:e.selectForm.courseType,callback:function(t){e.$set(e.selectForm,"courseType",t)},expression:"selectForm.courseType"}},e._l(e.courseData,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),e._v(" "),a("Button",{directives:[{name:"show",rawName:"v-show",value:"新建走班课程"==e.selectForm.title,expression:"selectForm.title == '新建走班课程'"}],attrs:{btnClass:"custom11",btnFontSize:"12px",btnHeight:"36px",title:"+添加"},on:{click:e.addCourse}})],1),e._v(" "),a("el-form-item",{attrs:{label:"年级：",prop:"grade"}},[a("el-select",{staticStyle:{width:"250px"},attrs:{placeholder:"请选择年级",size:"medium"},on:{change:e.changeGrade},model:{value:e.selectForm.grade,callback:function(t){e.$set(e.selectForm,"grade",t)},expression:"selectForm.grade"}},e._l(e.gradeData,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"走班课程数量：",prop:"cousrseCount"}},[a("el-input-number",{staticStyle:{width:"250px"},attrs:{min:0,size:"medium"},on:{change:e.handleChange},model:{value:e.selectForm.cousrseCount,callback:function(t){e.$set(e.selectForm,"cousrseCount",t)},expression:"selectForm.cousrseCount"}})],1),e._v(" "),a("el-form-item",{staticClass:"choose-time",attrs:{label:"走班课程列表："}},[a("div",{staticClass:"inner-box"},[a("ul",{staticClass:"inner-top clearfix"},[a("li",[e._v("序号")]),e._v(" "),a("li",[e._v("走班课程")]),e._v(" "),a("li",[e._v("任课教师")]),e._v(" "),a("li",[e._v("操作")])]),e._v(" "),a("ul",{staticClass:"time-list"},[e._v("\n                "+e._s(e.selectForm.courseData)+"\n                "),e._l(e.selectForm.courseData,function(t,o){return a("li",{key:o},[a("div",[a("span",[e._v(e._s(o+1))])]),e._v(" "),a("div",[t.courseName?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.courseName,placement:"top"}},[a("el-input",{attrs:{placeholder:"输入走班课程",clearable:"",size:"small"},model:{value:t.courseName,callback:function(a){e.$set(t,"courseName",a)},expression:"item.courseName"}})],1):a("el-input",{attrs:{placeholder:"输入走班课程",clearable:"",size:"small"},model:{value:t.courseName,callback:function(a){e.$set(t,"courseName",a)},expression:"item.courseName"}})],1),e._v(" "),a("div",[a("el-select",{staticStyle:{width:"250px"},attrs:{placeholder:"选择教师",size:"medium"},on:{change:e.changeTeacher},model:{value:t.teacherName,callback:function(a){e.$set(t,"teacherName",a)},expression:"item.teacherName"}},e._l(e.teacherData,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("div",[a("el-button",{staticClass:"warning",attrs:{size:"mini",plain:""},on:{click:function(a){return e.delCourse(t,o)}}},[e._v("删除")])],1)])})],2)])])],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{title:"取消",btnClass:"custom7",btnFontSize:"12px",btnHeight:"4.5vh"},on:{click:function(t){e.selectFormDialog=!1}}}),e._v(" "),a("Button",{attrs:{title:"保存",btnClass:"custom8",btnFontSize:"12px",btnHeight:"4.5vh"},on:{click:e.saveClassfiedSubjectClick}})],1)]),e._v(" "),a("el-dialog",{staticClass:"member-dialog",attrs:{title:e.courseForm.title,visible:e.courseFormDialog,width:"560px",center:""},on:{"update:visible":function(t){e.courseFormDialog=t}}},[a("div",{staticClass:"content"},[a("el-form",{ref:"courseForm",attrs:{"label-width":"100px",rules:e.rules,model:e.courseForm}},[a("el-form-item",{attrs:{label:"课程名称：",prop:"name"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入课程名称",size:"small"},model:{value:e.courseForm.name,callback:function(t){e.$set(e.courseForm,"name",t)},expression:"courseForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注：",prop:"remarks"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入备注内容",type:"textarea",autosize:{minRows:3,maxRows:6},size:"small"},model:{value:e.courseForm.remarks,callback:function(t){e.$set(e.courseForm,"remarks",t)},expression:"courseForm.remarks"}})],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{title:"取消",btnClass:"custom7",btnFontSize:"12px",btnHeight:"4.5vh"},on:{click:function(t){e.courseFormDialog=!1}}}),e._v(" "),a("Button",{attrs:{title:"保存",btnClass:"custom8",btnFontSize:"12px",btnHeight:"4.5vh"},on:{click:e.saveClassfiedSubjectClick}})],1)]),e._v(" "),e.isToast?a("Toast",{attrs:{"modal-title":e.toast,duration:"1500"},on:{toastCancel:e.hideToast}}):e._e()],1)},d=[],m={render:c,staticRenderFns:d},u=m,g=a("VU/8"),h=o,p=g(r,u,!1,h,"data-v-0c79e9e2",null);t.default=p.exports},"/jDi":function(e,t,a){var o=a("cjI7");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a("rjj0")("24bf633c",o,!0,{})},cjI7:function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,"\n.select-course-manage[data-v-0c79e9e2] {\n  width: 100%;\n  height: 100%;\n  margin: 0 auto;\n  background-color: #fff;\n}\n.select-course-manage .term-top[data-v-0c79e9e2] {\n    height: 60px;\n    line-height: 60px;\n    border-bottom: 1px solid #e1e1e1;\n    -webkit-box-sizing: content-box;\n            box-sizing: content-box;\n    padding-left: 35px;\n    font-size: 18px;\n}\n.select-course-manage .term-top dd[data-v-0c79e9e2] {\n      float: left;\n      font-size: 18px;\n      font-weight: bold;\n}\n.select-course-manage .term-top dd span[data-v-0c79e9e2] {\n        font-size: 14px;\n        font-weight: normal;\n}\n.select-course-manage .term-top .search-box[data-v-0c79e9e2] {\n      width: 200px;\n      height: 36px;\n      float: left;\n      margin: 0px 80px 0px 20px;\n      margin-right: 10px;\n      background: #fff;\n      position: relative;\n}\n.select-course-manage .term-top .search-box .el-input i[data-v-0c79e9e2] {\n        cursor: pointer;\n}\n.select-course-manage .term-top .button-div[data-v-0c79e9e2] {\n      float: right;\n      margin-right: 20px;\n      margin-top: 11px;\n}\n.select-course-manage .table-box td:nth-of-type(2) img[data-v-0c79e9e2],\n  .select-course-manage .table-box td:nth-of-type(2) span[data-v-0c79e9e2] {\n    vertical-align: middle;\n}\n.select-course-manage .table-box td:nth-of-type(2) span[data-v-0c79e9e2] {\n    margin-left: 5px;\n}\n.select-course-manage .table-box[data-v-0c79e9e2] .el-table thead tr th {\n    height: 5vh !important;\n}\n.select-course-manage .pagination-box[data-v-0c79e9e2] {\n    width: 100%;\n    height: 60px;\n    background: #fff;\n    -webkit-box-sizing: content-box;\n            box-sizing: content-box;\n}\n.select-course-manage .pagination-box .el-pagination[data-v-0c79e9e2] {\n      padding-top: 15px;\n}\n.select-course-manage .member-dialog[data-v-0c79e9e2] .el-dialog {\n    margin-top: 15vh !important;\n}\n.select-course-manage .member-dialog[data-v-0c79e9e2] .el-dialog .el-select__input {\n      display: inline !important;\n      border: none !important;\n}\n.select-course-manage .member-dialog[data-v-0c79e9e2] .el-dialog .el-dialog__body {\n      padding-bottom: 0 !important;\n}\n.select-course-manage .member-dialog[data-v-0c79e9e2] .el-dialog .el-form {\n      text-align: left;\n}\n.select-course-manage .member-dialog[data-v-0c79e9e2] .el-dialog .el-form .el-form-item {\n        padding-bottom: 0 !important;\n}\n.select-course-manage .member-dialog[data-v-0c79e9e2] .el-dialog .el-form .el-form-item__content .el-select {\n        margin-right: 10px;\n}\n.select-course-manage .member-dialog[data-v-0c79e9e2] .el-dialog .el-form .choose-time .inner-box {\n        width: 520px;\n        overflow: hidden;\n        border: 1px solid #e1e1e1;\n        border-radius: 6px;\n        text-align: center;\n}\n.select-course-manage .member-dialog[data-v-0c79e9e2] .el-dialog .el-form .choose-time .inner-box .inner-top {\n          width: 520px;\n          height: 40px;\n          line-height: 40px;\n          display: -webkit-box;\n          display: -ms-flexbox;\n          display: flex;\n}\n.select-course-manage .member-dialog[data-v-0c79e9e2] .el-dialog .el-form .choose-time .inner-box .inner-top li {\n            -webkit-box-flex: 1;\n                -ms-flex: 1;\n                    flex: 1;\n            font-size: 12px;\n            color: #606266;\n}\n.select-course-manage .member-dialog[data-v-0c79e9e2] .el-dialog .el-form .choose-time .inner-box .inner-top li:nth-of-type(2) {\n              -ms-flex-preferred-size: 140px;\n                  flex-basis: 140px;\n              max-width: 140px;\n}\n.select-course-manage .member-dialog[data-v-0c79e9e2] .el-dialog .el-form .choose-time .inner-box .time-list {\n          width: 520px;\n          max-height: 240px;\n          overflow: auto;\n}\n.select-course-manage .member-dialog[data-v-0c79e9e2] .el-dialog .el-form .choose-time .inner-box .time-list li {\n            width: 100%;\n            height: 40px;\n            line-height: 40px;\n            overflow: hidden;\n            border-top: 1px solid #e1e1e1;\n            display: -webkit-box;\n            display: -ms-flexbox;\n            display: flex;\n}\n.select-course-manage .member-dialog[data-v-0c79e9e2] .el-dialog .el-form .choose-time .inner-box .time-list li > div {\n              font-size: 12px;\n              color: #606266;\n              -webkit-box-flex: 1;\n                  -ms-flex: 1;\n                      flex: 1;\n              padding: 0 10px;\n}\n.select-course-manage .member-dialog[data-v-0c79e9e2] .el-dialog .el-form .choose-time .inner-box .time-list li > div:nth-of-type(2) {\n                -ms-flex-preferred-size: 140px;\n                    flex-basis: 140px;\n                max-width: 140px;\n}\n.select-course-manage .member-dialog[data-v-0c79e9e2] .el-dialog .el-form .choose-time .inner-box .button-div {\n          margin: 10px 20px;\n}\n.select-course-manage .member-dialog[data-v-0c79e9e2] .el-dialog .button-div {\n      margin-right: 20px;\n}\n",""])}});