webpackJsonp([54],{"75TH":function(t,e,a){var o=a("fP0r");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a("rjj0")("5a1fd3ac",o,!0,{})},fP0r:function(t,e,a){e=t.exports=a("FZ+f")(!1),e.push([t.i,"\n.visitor-turnover[data-v-250743a8] {\n  width: 100%;\n  height: 100%;\n  margin: 0 auto;\n}\n.visitor-turnover .turn-top[data-v-250743a8] {\n    width: 100%;\n    height: auto;\n    background: #fff;\n    margin-bottom: 15px;\n    padding: 0 35px;\n}\n.visitor-turnover .turn-top .turn-box[data-v-250743a8] {\n      width: 100%;\n      height: 50px;\n      border-bottom: 1px solid #E1E1E1;\n      line-height: 50px;\n      font-size: 12px;\n      color: #333;\n}\n.visitor-turnover .turn-top .turn-box span[data-v-250743a8] {\n        margin: 0 20px;\n        margin-left: 0;\n}\n.visitor-turnover .turn-top .turn-box[data-v-250743a8] button {\n        color: #AAAAAA;\n        margin-left: 10px;\n}\n.visitor-turnover .turn-top .turn-box[data-v-250743a8] button span {\n          margin-right: 10px;\n}\n.visitor-turnover .turn-top .turn-box button.on[data-v-250743a8] {\n        color: #333;\n}\n.visitor-turnover .turn-top .turn-box[data-v-250743a8] .el-date-editor {\n        margin: 0 10px;\n}\n.visitor-turnover .turn-top .turn-box[data-v-250743a8] .el-date-editor span {\n          margin: 0;\n          font-size: 12px;\n}\n.visitor-turnover .turn-top .turn-box[data-v-250743a8] .el-date-editor input:focus {\n          border: 0 !important;\n}\n.visitor-turnover .turn-top .turn-box .el-select .el-input input[data-v-250743a8] {\n        height: 40px !important;\n}\n.visitor-turnover .turn-top .turn-box .el-select .el-input span[data-v-250743a8] {\n        margin: 0;\n}\n.visitor-turnover .turn-top .turn-box[data-v-250743a8]:last-child {\n        border: 0;\n}\n.visitor-turnover .turn-bottom[data-v-250743a8] {\n    width: 100%;\n    height: auto;\n    background: #fff;\n}\n.visitor-turnover .turn-bottom .operate-box[data-v-250743a8] {\n      width: 100%;\n      height: 60px;\n      line-height: 60px;\n      -webkit-box-sizing: content-box;\n              box-sizing: content-box;\n      border-bottom: 1px solid #e1e1e1;\n}\n.visitor-turnover .turn-bottom .operate-box span[data-v-250743a8] {\n        font-size: 18px;\n        font-weight: bold;\n        color: #333;\n        margin-left: 35px;\n}\n.visitor-turnover .turn-bottom .operate-box .exportBtn[data-v-250743a8] {\n        width: 90px;\n        margin: 5px 20px;\n        background: #F5F6F5 !important;\n        border: 1px solid #E6E6E6 !important;\n        color: #333;\n}\n.visitor-turnover .turn-bottom .operate-box .exportBtn[data-v-250743a8]:hover {\n        background: #1cab7d !important;\n        color: #fff !important;\n}\n.visitor-turnover .turn-bottom .operate-box .search-box[data-v-250743a8] {\n        width: 200px;\n        height: 36px;\n        float: right;\n        margin: 0px 80px 0px 20px;\n        margin-right: 10px;\n        background: #fff;\n        position: relative;\n}\n.visitor-turnover .turn-bottom .operate-box .search-box .el-input i[data-v-250743a8] {\n          cursor: pointer;\n}\n.visitor-turnover .turn-bottom .operate-box #exportForm[data-v-250743a8] {\n        display: none;\n}\n.visitor-turnover .turn-bottom[data-v-250743a8] .el-table__fixed-right-patch {\n      background: #F7F9FB;\n}\n.visitor-turnover .turn-bottom .pagination-box[data-v-250743a8] {\n      width: 100%;\n      height: 60px;\n      background: #fff;\n      -webkit-box-sizing: content-box;\n              box-sizing: content-box;\n}\n.visitor-turnover .turn-bottom .pagination-box .el-pagination[data-v-250743a8] {\n        padding-top: 15px;\n}\n.el-popover[data-v-250743a8] {\n  padding: 36px 50px 50px !important;\n}\n.el-popover .img-div[data-v-250743a8] {\n    display: inline-block;\n    margin: 5px 10px;\n    text-align: center;\n}\n.el-popover .img-div img[data-v-250743a8] {\n      display: block;\n      width: 480px !important;\n      height: 270px;\n}\n.el-popover .img-div > div[data-v-250743a8] {\n      height: 25px;\n      line-height: 25px;\n}\n.el-popover .img-div > div[data-v-250743a8]:first-child {\n        margin-top: 10px;\n}\n",""])},"klO+":function(t,e,a){"use strict";function o(t){a("75TH")}Object.defineProperty(e,"__esModule",{value:!0});var n=a("bOdI"),i=a.n(n),r=a("bWJ8"),s=a("qqG0"),l={name:"HelloWorld",components:{Button:r.a,Toast:s.a},computed:{defaultErrImg:function(){return'this.src="'+this.$store.state.Common.defaultErrImg+'"'}},data:function(){var t;return t={userNo:localStorage.getItem("userNo")?localStorage.getItem("userNo"):"",daterange:"",sections:[{value:"1",label:"产品"},{value:"2",label:"设计"},{value:"3",label:"技术"},{value:"4",label:"人事"},{value:"5",label:"财务"}],section:"",mySearch:"",tableData:[{visitorName:"王小二",visitorTel:"13930232345",identityNo:"370000199901011234",visitorState:"来访中",visitorType:"受邀访客",visitorReason:"办公",touserName:"admin",visitorBegin:"2016-11-02 16:00",visitorInTime:"2016-11-02 16:00",visitorOutTime:"",photoType:""},{visitorName:"毛晓玲",visitorTel:"13930232345",identityNo:"370000199901011234",visitorState:"来访结束",visitorType:"预约访客",visitorReason:"办公",touserName:"admin",visitorBegin:"",visitorInTime:"2016-11-02 16:00",visitorOutTime:"2016-11-02 16:00",photoType:"15348395260.e3h96dh5a7f09.jpg;15349885350.118830e652g97.jpg",visitorInPhoto:"15349885350.118830e652g97.jpg",visitorOutPhoto:"15348395260.e3h96dh5a7f09.jpg"}]},i()(t,"tableData",[]),i()(t,"visitorState",[{visitorStateValue:"来访中",visitorState:"1"},{visitorStateValue:"来访结束",visitorState:"2"},{visitorStateValue:"未到",visitorState:"3"},{visitorStateValue:"全部",visitorState:""}]),i()(t,"visitorState",[]),i()(t,"visitorType",[{visitorTypeValue:"全部",visitorType:1},{visitorTypeValue:"受邀访客",visitorType:2},{visitorTypeValue:"预约访客",visitorType:3},{visitorTypeValue:"通行证访客",visitorType:4}]),i()(t,"visitorType",[]),i()(t,"onState",""),i()(t,"onType",""),i()(t,"onTime",1),i()(t,"showIndex",!1),i()(t,"allNum",0),i()(t,"currentPage",1),i()(t,"tableLoading",!1),i()(t,"pageItem",20),i()(t,"isToast",!1),i()(t,"toast",""),t},methods:{search:function(){this.getTableData()},exportExcel:function(){$("#exportForm").submit()},selectVisitorState:function(t){this.onState=t.visitorState,this.getTableData()},selectVisitorType:function(t){this.onType=t.visitorType,this.getTableData()},selectToday:function(t){this.onTime=1,this.daterange=[],this.getTableData()},changeDateRange:function(t){this.onTime="",this.currentPage=1,this.getTableData()},getTableData:function(){var t=this,e=void 0;if(1==this.onTime){var a=(new Date).getFullYear(),o=(new Date).getMonth()+1;o=o<10?"0"+o:o;var n=(new Date).getDate();n=n<10?"0"+n:n;var i=(new Date).getHours();i=i<10?"0"+i:i;var r=(new Date).getMinutes();r=r<10?"0"+r:r;var s=(new Date).getSeconds();s=s<10?"0"+s:s;e=[a+"-"+o+"-"+n+" 00:00:00",a+"-"+o+"-"+n+" 23:59:59"]}else e=this.daterange;var l={count:!0,page_index:this.currentPage,page_size:this.pageItem,search:{visitorState:this.onState,visitorType:this.onType,visitorBegin:e[0],visitorEnd:e[1],visitorName:this.mySearch,touserId:localStorage.getItem("userId")}};this.tableLoading=!0,this.$api.DataCount.getVisitorRecord(l).then(function(e){t.tableLoading=!1,600==e.data.code||0==e.data.code?(null!=e.data.data?t.allNum=e.data.data.total_record:t.allNum=0,t.tableData=e.data.data.records,t.getSpanArr(t.tableData),t.loadLimitData()):(t.allNum=0,t.isToast=!0,t.toast=e.data.msg)}).catch(function(e){t.tableLoading=!1})},getStateData:function(){var t=this;this.$api.DataCount.getVisitorState().then(function(e){600==e.data.code||0==e.data.code?t.visitorState=e.data.data:(t.isToast=!0,t.toast=e.data.msg)})},getTypeData:function(){var t=this;this.$api.DataCount.getVisitorType().then(function(e){600==e.data.code||0==e.data.code?t.visitorType=e.data.data:(t.isToast=!0,t.toast=e.data.msg)})},objectSpanMethod:function(t){var e=(t.row,t.column,t.rowIndex);if(t.columnIndex<=8){var a=this.spanArr[e];return{rowspan:a,colspan:a>0?1:0}}},getSpanArr:function(t){this.spanArr=[];for(var e=0;e<t.length;e++)0==e?(this.spanArr.push(1),this.pos=0):(t[e].recordTime,t[e-1].recordTime,t[e].userId==t[e-1].userId&&(t[e].recordTime?t[e].recordTime.substring(0,10):"")==(t[e-1].recordTime?t[e-1].recordTime.substring(0,10):"")?(this.spanArr[this.pos]+=1,this.spanArr.push(0)):(this.spanArr.push(1),this.pos=e))},handleSelectionChange:function(t){this.multipleSelection=t},toggleSelection:function(t){this.$refs.multipleTable.toggleRowSelection(t)},handleSizeChange:function(t){this.pageItem=t,this.currentPage=1,this.changePage(this.pageItem,this.currentPage)},handleCurrentChange:function(t){this.currentPage=t,this.getTableData()},hideToast:function(){this.isToast=!1},loadLimitData:function(){for(var t=this,e=0,a=0;a<t.tableData.length;a++)0===a?e=1:t.tableData[a].id!=t.tableData[a-1].id&&e++,t.$set(t.tableData[a],"indexID",(t.currentPage-1)*t.pageSize+1*e)}},mounted:function(){setTimeout(function(){var t=$(".index > .m-cen").height(),e=$(".turn-top").height(),a=$(".operate-box").height(),o=$(".pagination-box").height(),n=t-e-a-o-15;$(".table-box").height(n)},5),this.getStateData(),this.getTypeData(),this.getTableData()}},p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"visitor-turnover"},[a("div",{staticClass:"turn-top"},[a("div",{staticClass:"turn-box"},[a("span",[t._v("访客状态：")]),t._v(" "),t._l(t.visitorState,function(e){return a("el-button",{key:e.visitorState,class:{on:t.onState===e.visitorState},attrs:{type:"text"},on:{click:function(a){return t.selectVisitorState(e)}}},[t._v("\n                "+t._s(e.visitorStateValue))])})],2),t._v(" "),a("div",{staticClass:"turn-box"},[a("span",[t._v("访客类型：")]),t._v(" "),t._l(t.visitorType,function(e){return a("el-button",{key:e.visitorType,class:{on:t.onType==e.visitorType},attrs:{type:"text"},on:{click:function(a){return t.selectVisitorType(e)}}},[t._v("\n                "+t._s(e.visitorTypeValue))])})],2),t._v(" "),a("div",{staticClass:"turn-box"},[a("span",[t._v("日期范围：")]),t._v(" "),a("el-button",{class:{on:1==t.onTime},attrs:{type:"text"},on:{click:t.selectToday}},[t._v("今天")]),t._v(" "),a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"]},on:{change:t.changeDateRange},model:{value:t.daterange,callback:function(e){t.daterange=e},expression:"daterange"}})],1)]),t._v(" "),a("div",{staticClass:"turn-bottom"},[a("div",{staticClass:"operate-box"},[a("span",[t._v(t._s(t.allNum)+"条访客记录")]),t._v(" "),a("iframe",{staticStyle:{display:"none"},attrs:{id:"id_iframe",name:"id_iframe"}}),t._v(" "),a("div",{staticClass:"search-box"},[a("el-input",{attrs:{size:"small",placeholder:"请输入访客姓名/被访人姓名"},on:{change:t.search},model:{value:t.mySearch,callback:function(e){t.mySearch=e},expression:"mySearch"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"suffix"},on:{click:t.search},slot:"suffix"})])],1)]),t._v(" "),a("div",{staticClass:"table-box"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{id:"table",height:"100%",data:t.tableData,"tooltip-effect":"dark","highlight-current-row":"","span-method":t.objectSpanMethod,border:""},on:{"row-click":t.toggleSelection,"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{prop:"visitorName",label:"姓名",align:"center","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"dicFmtMap",label:"访客状态",align:"center","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.dicFmtMap.visitorStatecn?a("span",[t._v(t._s(e.row.dicFmtMap.visitorStatecn))]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"dicFmtMap",label:"访客类型",align:"center","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.dicFmtMap.visitorTypecn?a("span",[t._v(t._s(e.row.dicFmtMap.visitorTypecn))]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"visitorTel",label:"电话号码",align:"center","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"identityNo",label:"身份证号码","min-width":"100",align:"center","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"visitorReason",label:"来访原因",align:"center","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"touserName",label:"来访对象",align:"center","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"visitorBegin",label:"计划来访时间","min-width":"110",align:"center","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.visitorBegin?a("span",[t._v("\n                            "+t._s(3==e.row.visitorType&&""!=e.row.visitorBegin?e.row.visitorBegin.substring(0,10)+"至"+e.row.visitorEnd.substring(0,10):e.row.visitorBegin)+"\n                        ")]):a("span",[t._v("——")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"recordTime",label:"签到日期",align:"center","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.recordTime?a("span",[t._v("\n                            "+t._s(e.row.recordTime.substring(0,10))+"\n                        ")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"recordTime",label:"签到时间",align:"center","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.recordTime?a("span",[t._v("\n                            "+t._s(e.row.recordTime.substring(e.row.recordTime.lastIndexOf(" ")+1,e.row.recordTime.lastIndexOf(" ").length))+"\n                        ")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"dicFmtMap",label:"进出方向",align:"center","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.dicFmtMap.recordFxcn?a("span",[t._v(t._s(e.row.dicFmtMap.recordFxcn))]):a("span",[t._v("——")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"photoPath",label:"照片抓拍"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.photoPath?a("el-popover",{attrs:{trigger:"hover",placement:"bottom"}},[a("div",{staticClass:"img-div"},[""!=e.row.photoPath?a("img",{attrs:{src:t.uploadPicUrl+e.row.photoPath+"?imageView2/1/",onerror:t.defaultErrImg}}):t._e(),t._v(" "),a("div",[e.row.dicFmtMap.recordFxcn?a("div",[t._v(t._s(e.row.dicFmtMap.recordFxcn+"照片抓拍"))]):t._e(),t._v(" "),a("div",[t._v(t._s(e.row.recordTime))])])]),t._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{staticStyle:{background:"none",color:"#1cab7d",border:"none"},attrs:{size:"medium"}},[t._v("查看")])],1)]):a("span",[t._v("无")])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"pagination-box"},[a("el-pagination",{attrs:{background:"",layout:" prev, pager, next",total:t.allNum,"page-size":t.pageItem,"current-page":t.currentPage},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"current-change":t.handleCurrentChange}})],1)]),t._v(" "),t.isToast?a("Toast",{attrs:{"modal-title":t.toast,duration:"1000"},on:{toastCancel:t.hideToast}}):t._e()],1)},u=[],c={render:p,staticRenderFns:u},d=c,v=a("VU/8"),g=o,h=v(l,d,!1,g,"data-v-250743a8",null);e.default=h.exports}});